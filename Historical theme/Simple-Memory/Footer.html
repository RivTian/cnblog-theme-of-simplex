<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.js"></script>

<!-- ç”Ÿæˆåšå®¢ç›®å½•çš„JSä»£ç ï¼Œä¸¤çº§ç›®å½• -->
<script type="text/javascript">
  // change the title logo
  var logo = document.getElementById("blogLogo");
  logo.setAttribute(
    "src",
    "https://images.cnblogs.com/cnblogs_com/RioTian/2064912/o_241229125046_291735476446_.pic.jpg",
  );
  logo.setAttribute("alt", "Administrator");

  /*  
        è¿™æ®µä»£ç æŒ‰H2ã€H3æ ¼å¼ç”Ÿæˆä¸¤çº§èœå•
        å†™åšå®¢æŒ‰H2ã€H3æ ¼å¼å†™ï¼Œä¸ç„¶ç”Ÿæˆä¸äº†
        Markdownå†™ä½œæŒ‰##ã€###ä¸¤çº§ç›®å½•å†™
        å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ”¹å†™ä»£ç æˆä¸‰çº§èœå•
    */
  var BlogDirectory = {
    /* è·å–å…ƒç´ ä½ç½®ï¼Œè·æµè§ˆå™¨å·¦è¾¹ç•Œçš„è·ç¦»ï¼ˆleftï¼‰å’Œè·æµè§ˆå™¨ä¸Šè¾¹ç•Œçš„è·ç¦»ï¼ˆtopï¼‰*/
    getElementPosition: function (ele) {
      var topPosition = 0;
      var leftPosition = 0;
      while (ele) {
        topPosition += ele.offsetTop;
        leftPosition += ele.offsetLeft;
        ele = ele.offsetParent;
      }
      return {
        top: topPosition,
        left: leftPosition,
      };
    },
    /*è·å–æ»šåŠ¨æ¡å½“å‰ä½ç½® */
    getScrollBarPosition: function () {
      var scrollBarPosition =
        document.body.scrollTop || document.documentElement.scrollTop;
      return scrollBarPosition;
    },
    /* ç§»åŠ¨æ»šåŠ¨æ¡ï¼ŒfinalPos ä¸ºç›®çš„ä½ç½®ï¼Œinternal ä¸ºç§»åŠ¨é€Ÿåº¦ */
    moveScrollBar: function (finalpos, interval) {
      //è‹¥ä¸æ”¯æŒæ­¤æ–¹æ³•ï¼Œåˆ™é€€å‡º
      if (!window.scrollTo) {
        return false;
      }

      //çª—ä½“æ»šåŠ¨æ—¶ï¼Œç¦ç”¨é¼ æ ‡æ»šè½®
      window.onmousewheel = function () {
        return false;
      };

      //æ¸…é™¤è®¡æ—¶
      if (document.body.movement) {
        clearTimeout(document.body.movement);
      }

      //è·å–æ»šåŠ¨æ¡å½“å‰ä½ç½®
      var currentpos = BlogDirectory.getScrollBarPosition();

      var dist = 0;
      //åˆ°è¾¾é¢„å®šä½ç½®ï¼Œåˆ™è§£ç¦é¼ æ ‡æ»šè½®ï¼Œå¹¶é€€å‡º
      if (currentpos == finalpos) {
        window.onmousewheel = function () {
          return true;
        };
        return true;
      }
      //æœªåˆ°è¾¾ï¼Œåˆ™è®¡ç®—ä¸‹ä¸€æ­¥æ‰€è¦ç§»åŠ¨çš„è·ç¦»
      if (currentpos < finalpos) {
        dist = Math.ceil((finalpos - currentpos) / 10);
        currentpos += dist;
      }
      if (currentpos > finalpos) {
        dist = Math.ceil((currentpos - finalpos) / 10);
        currentpos -= dist;
      }

      var scrTop = BlogDirectory.getScrollBarPosition(); //è·å–æ»šåŠ¨æ¡å½“å‰ä½ç½®
      window.scrollTo(0, currentpos); //ç§»åŠ¨çª—å£
      if (BlogDirectory.getScrollBarPosition() == scrTop) {
        //è‹¥å·²åˆ°åº•éƒ¨ï¼Œåˆ™è§£ç¦é¼ æ ‡æ»šè½®ï¼Œå¹¶é€€å‡º
        window.onmousewheel = function () {
          return true;
        };
        return true;
      }

      //è¿›è¡Œä¸‹ä¸€æ­¥ç§»åŠ¨
      var repeat =
        "BlogDirectory.moveScrollBar(" + finalpos + "," + interval + ")";
      document.body.movement = setTimeout(repeat, interval);
    },

    htmlDecode: function (text) {
      var temp = document.createElement("div");
      temp.innerHTML = text;
      var output = temp.innerText || temp.textContent;
      temp = null;
      return output;
    },

    /*
        åˆ›å»ºåšå®¢ç›®å½•ï¼Œidè¡¨ç¤ºåŒ…å«åšæ–‡æ­£æ–‡çš„ div å®¹å™¨çš„ idï¼Œ
        mt å’Œ st åˆ†åˆ«è¡¨ç¤ºä¸»æ ‡é¢˜å’Œæ¬¡çº§æ ‡é¢˜çš„æ ‡ç­¾åç§°ï¼ˆå¦‚ H2ã€H3ï¼Œå¤§å†™æˆ–å°å†™éƒ½å¯ä»¥ï¼ï¼‰ï¼Œ
        interval è¡¨ç¤ºç§»åŠ¨çš„é€Ÿåº¦
        */
    createBlogDirectory: function (id, mt, st, interval) {
      //è·å–åšæ–‡æ­£æ–‡divå®¹å™¨
      var elem = document.getElementById(id);
      if (!elem) return false;
      //è·å–divä¸­æ‰€æœ‰å…ƒç´ ç»“ç‚¹
      var nodes = elem.getElementsByTagName("*");
      //åˆ›å»ºåšå®¢ç›®å½•çš„divå®¹å™¨
      var divSideBar = document.createElement("DIV");
      divSideBar.className = "uprightsideBar";
      divSideBar.setAttribute("id", "uprightsideBar");

      var divSideBarTab = document.createElement("DIV");
      divSideBarTab.setAttribute("id", "sideBarTab");

      var p = document.createElement("p");
      divSideBarTab.appendChild(p);
      var txt = document.createTextNode("ğŸ“–ç›®å½•");
      p.setAttribute("id", "catalogHeadTitle");
      p.appendChild(txt);

      var divSideBarContents = document.createElement("DIV");
      divSideBarContents.style.display = "none";
      divSideBarContents.setAttribute("id", "sideBarContents");

      divSideBar.appendChild(divSideBarTab);
      divSideBar.appendChild(divSideBarContents);

      //åˆ›å»ºè‡ªå®šä¹‰åˆ—è¡¨
      var dlist = document.createElement("dl");
      divSideBarContents.appendChild(dlist);
      var num = 0; //ç»Ÿè®¡æ‰¾åˆ°çš„mtå’Œst
      mt = mt.toUpperCase(); //è½¬åŒ–æˆå¤§å†™
      st = st.toUpperCase(); //è½¬åŒ–æˆå¤§å†™
      //éå†æ‰€æœ‰å…ƒç´ ç»“ç‚¹
      for (var i = 0; i < nodes.length; i++) {
        if (nodes[i].nodeName == mt || nodes[i].nodeName == st) {
          //è·å–æ ‡é¢˜æ–‡æœ¬

          var nodetext = nodes[i].innerHTML.replace(/<\/?[^>]+>/g, ""); //innerHTMLé‡Œé¢çš„å†…å®¹å¯èƒ½æœ‰HTMLæ ‡ç­¾ï¼Œæ‰€ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼å»é™¤HTMLçš„æ ‡ç­¾
          // nodetext = nodetext.replace(/ /ig, "");//æ›¿æ¢æ‰æ‰€æœ‰çš„ç©ºæ ¼
          nodetext = BlogDirectory.htmlDecode(nodetext);
          //æ’å…¥é”š
          nodes[i].setAttribute("id", "blogTitle" + num);
          var item;
          switch (nodes[i].nodeName) {
            case mt: //è‹¥ä¸ºä¸»æ ‡é¢˜
              item = document.createElement("dt");
              var itemtext = document.createTextNode(nodetext);
              break;
            case st: //è‹¥ä¸ºå­æ ‡é¢˜
              item = document.createElement("dd");
              var itemtext = document.createTextNode("â€¢ " + nodetext);
              break;
          }

          //åˆ›å»ºé”šé“¾æ¥
          item.appendChild(itemtext);
          item.setAttribute("name", num);
          //æ·»åŠ é¼ æ ‡ç‚¹å‡»è§¦å‘å‡½æ•°
          item.onclick = function () {
            var pos = BlogDirectory.getElementPosition(
              document.getElementById("blogTitle" + this.getAttribute("name")),
            );
            if (!BlogDirectory.moveScrollBar(pos.top, interval)) return false;
          };
          //å°†è‡ªå®šä¹‰è¡¨é¡¹åŠ å…¥è‡ªå®šä¹‰åˆ—è¡¨ä¸­
          dlist.appendChild(item);
          num++;
        }
      }

      if (num == 0) return false;
      // å¦‚æœæ˜¯ç§»åŠ¨ç«¯ï¼Œé€šè¿‡ç‚¹å‡»çš„æ–¹å¼æ¥æ˜¾ç¤ºæˆ–éšè—ç›®å½•
      // å¦‚æœæ˜¯PCç«¯ï¼Œé€šè¿‡é¼ æ ‡èšç„¦çš„æ–¹å¼æ¥æ˜¾ç¤ºæˆ–éšè—
      if (isMobile()) {
        divSideBarContents.style.borderRadius = "0px 6px 6px 6px";
        divSideBar.onclick = function () {
          var status = divSideBarContents.style.display;
          if (status == "block") {
            document.getElementById("catalogHeadTitle").innerText = "ğŸ“–ç›®å½•";
            divSideBarTab.style.borderRadius = "6px";
            divSideBarContents.style.display = "none";
          } else if (status == "none") {
            document.getElementById("catalogHeadTitle").innerText = "âå…³é—­";
            divSideBarTab.style.borderRadius = "6px 0px 0px 6px";
            divSideBarContents.style.display = "block";
          }
        };
      } else {
        /* é¼ æ ‡è¿›å…¥æ—¶çš„äº‹ä»¶å¤„ç† */
        divSideBarTab.onmouseenter = function () {
          divSideBarContents.style.display = "block";
        };
        /* é¼ æ ‡ç¦»å¼€æ—¶çš„äº‹ä»¶å¤„ç† */
        divSideBar.onmouseleave = function () {
          divSideBarContents.style.display = "none";
        };
      }
      document.body.appendChild(divSideBar);
    },
  };

  // åˆ¤æ–­æµè§ˆå™¨å‡½æ•°
  function isMobile() {
    if (
      window.navigator.userAgent.match(
        /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i,
      )
    ) {
      return true; // ç§»åŠ¨ç«¯
    } else {
      return false; // PCç«¯
    }
  }

  window.onload = function () {
    /* é¡µé¢åŠ è½½å®Œæˆä¹‹åç”Ÿæˆåšå®¢ç›®å½• */
    BlogDirectory.createBlogDirectory("cnblogs_post_body", "h2", "h3", 20);
  };
</script>

<!-- è¿”å›é¡¶éƒ¨åŠŸèƒ½-->
<script type="text/javascript">
  (function () {
    var $backToTopTxt = "è¿”å›é¡¶éƒ¨",
      $backToTopEle = $('<div class="backToTop"></div>')
        .appendTo($("body"))
        .text($backToTopTxt)
        .attr("title", $backToTopTxt)
        .click(function () {
          $("html, body").animate(
            {
              scrollTop: 0,
            },
            120,
          );
        }),
      $backToTopFun = function () {
        var st = $(document).scrollTop(),
          winh = $(window).height();
        st > 0 ? $backToTopEle.show() : $backToTopEle.hide();
        //IE6ä¸‹çš„å®šä½
        if (!window.XMLHttpRequest) {
          $backToTopEle.css("top", st + winh - 166);
        }
      };
    $(window).bind("scroll", $backToTopFun);
    $(function () {
      $backToTopFun();
    });
  })();
</script>

<!-- Chatra {literal} -->
<script>
  (function (d, w, c) {
    w.ChatraID = "DG4xk9nE2HXoMr7GD";
    var s = d.createElement("script");
    w[c] =
      w[c] ||
      function () {
        (w[c].q = w[c].q || []).push(arguments);
      };
    s.async = true;
    s.src = "https://call.chatra.io/chatra.js";
    if (d.head) d.head.appendChild(s);
  })(document, window, "Chatra");
</script>
<!-- /Chatra {/literal} -->

<script>
  // fancybox
  $(".cnblogs-markdown img").each(function () {
    var element = document.createElement("a");
    // ç‚¹å‡»å¢å¤§ä»¥åŠç‚¹å‡»å‰å¾€å¦ä¸€ä¸ªé¡µé¢
    // $(element).attr("data-fancybox", "gallery");
    // $(element).attr("href", $(this).attr("src"));
    $(element).attr("data-caption", $(this).attr("alt"));
    $(this).wrap(element);
    if ($(this).attr("alt") != "") {
      $(this)
        .parent()
        .after('<div class="img-caption">' + $(this).attr("alt") + "</div>");
    }
  });
</script>

